<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <body>
        <h1>Liberate the Hostname</h1>
        <p>How to liberate your hostname:</p>
        <ol>
            <li>
                Type your hostname here and submit:
                <form id="submit">
                    <label for="submit-hostname">Hostname</label>
                    <input type="text" id="submit-hostname"/>
                    <button type="submit">Submit</button>
                </form>
            </li>
            <li>
                Create the following DNS records:
                <pre>CNAME <span id="cname-name">PENDING</span> <span id="cname-value">PENDING</span></pre>
                <pre>TXT <span id="txt-name">PENDING</span> <span id="txt-value">PENDING</span></pre>
            </li>
            <li>
                Wait for the Custom Hostname verification to complete. If you created the DNS records within the first few minutes, verification should complete almost immediately. You can check the status here:
                <form id="check">
                    <label for="check-hostname">Hostname</label>
                    <input type="text" id="check-hostname"/>
                    <button type="submit">Check</button>
                </form>
                Status: <pre><span id="status"></span></pre>
            </li>
            <li>
                Once the Custom Hostname has been verified, it will be deleted after a couple of minutes. You hostname has now been liberated!
            </li>
        </ol>
        <script type="text/javascript">
            document.getElementById('submit').addEventListener('submit', async (event) => {
                event.preventDefault()
                const hostname = document.getElementById('submit-hostname').value
                const response = await fetch('/submit', {body: hostname, method: 'POST'})
                const result = await response.json()
                document.getElementById('cname-name').textContent = result.hostname
                document.getElementById('cname-value').textContent = 'fallback.ssl-for-saas.cf'
                document.getElementById('txt-name').textContent = result.ownership_verification.name
                document.getElementById('txt-value').textContent = result.ownership_verification.value
            })
            document.getElementById('check').addEventListener('submit', async (event) => {
                event.preventDefault()
                const hostname = document.getElementById('check-hostname').value
                const response = await fetch('/check', {body: hostname, method: 'POST'})
                document.getElementById('status').textContent = await response.text()
            })
        </script>
    </body>
</html>
